{{include 'admin/public/header.html'}}

<!-- 引入UEditor目录下的3个js文件 -->
<script type="text/javascript" charset="UTF-8" src="/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="UTF-8" src="/ueditor/ueditor.all.min.js"></script>
<script type="text/javascript" charset="UTF-8" src="/ueditor/lang/zh-cn/zh-cn.js"></script>


<body>
<div class="navbar navbar-default" id="navbar">
    <script type="text/javascript">
        try {
            ace.settings.check('navbar', 'fixed')
        } catch (e) {
        }
    </script>

    {{include 'admin/public/nav_top.html'}}
</div>

<div class="main-container" id="main-container">
    <script type="text/javascript">
        try {
            ace.settings.check('main-container', 'fixed')
        } catch (e) {
        }
    </script>

    <div class="main-container-inner">
        <a class="menu-toggler" id="menu-toggler" href="#">
            <span class="menu-text"></span>
        </a>

        <!--左侧导航-->

        {{include 'admin/public/nav_left.html'}}

        <div class="main-content">
            {{include 'admin/public/nav_title_top.html'}}

            <div class="page-content">

                <div class="page-header">
                    <h1>
                        增加文章内容
                    </h1>
                </div><!-- /.page-header -->

                <!--表格-->

                <div class="table-responsive">
                    <!-- 要上传文件 必须要加这个玩意 enctype="multipart/form-data" -->
                    <form action="{{__HOST__}}/admin/article/doEdit" method="post" class="form-horizontal" role="form"
                          enctype="multipart/form-data">

                        <!-- 处理成分页状态  -->
                        <ul id="myTab" class="nav nav-tabs" style="height: 44px">
                            <li class="active">
                                <!-- href 必须与对应页id相关联 -->
                                <a href="#basic" data-toggle="tab">
                                    基本设置
                                </a>
                            </li>
                            <li>
                                <a href="#content" data-toggle="tab">
                                    内容设置
                                </a>
                            </li>
                            <li>
                                <a href="#seo" data-toggle="tab">
                                    SEO设置
                                </a>
                            </li>
                        </ul>
                        <!-- style="border: none" 去掉边框 -->
                        <div id="myTabContent" class="tab-content" style="border: none">
                            <!-- 基本设置 -->
                            <div class="tab-pane fade in active" id="basic">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right" for="pid">所属分类：</label>

                                    <div class="col-sm-10">
                                        <!-- 通过 option pid catename 在底部写js代码监听事件的改变 -->
                                        <select name="pid" id="pid">
                                            {{each articlelist}}
                                            <option value="{{@$value._id}}" label="{{$value.title}}"
                                                    {{if list.pid==$value._id}}selected {{/if}}>{{$value.title}}</option>
                                            {{each $value.list}}
                                            <option value="{{@$value._id}}" label="╚═▷{{$value.title}}"
                                                    {{if list.pid==$value._id}}selected {{/if}}>{{$value.title}}</option>
                                            {{/each}}
                                            {{/each}}

                                        </select>
                                    </div>
                                    <input type="hidden" name="catename" id="catename" value="{{list.catename}}"/>
                                    <input type="hidden" name="id" id="id" value="{{@list._id}}"/>
                                    <input type="hidden" name="pervPage" id="pervPage" value="{{pervPage}}"/>
                                </div>


                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right" for="title">名称:</label>

                                    <div class="col-sm-10">
                                        <input type="text" id="title" name="title" class="col-xs-10 col-sm-5"
                                               value="{{list.title}}"/>
                                    </div>
                                </div>
                                <div class="form-group" {{if list.img !='' }}style="height: 120px" {{/if}} >
                                <label class="col-sm-2 control-label no-padding-right" for="title">封面图:</label>

                                <div class="col-sm-10">
                                    <input type="file" id="file" name="img_url" class="col-xs-10 col-sm-5"/>
                                    {{if list.img != ''}}
                                    <div>
                                        <br/><br/>
                                        <img src="{{__HOST__}}/{{list.img}}"
                                             style="width: 80px; height: 80px; float:left">
                                        <br/><br/>
                                    </div>
                                    {{/if}}
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label no-padding-right" for="title">作者:</label>

                                <div class="col-sm-10">
                                    <input type="text" id="author" name="author" class="col-xs-10 col-sm-5"
                                           value="{{list.author}}"/>
                                </div>
                            </div>


                            <div class="form-group">
                                <label class="col-sm-2 control-label no-padding-right">状态：</label>
                                <div class="col-sm-10">
                                    <label for="status1">已审核：</label><input type="radio" name="status" id="status1"
                                                                            value="1" {{if list.status==1 }} checked {{/if}}
                                    />
                                    &emsp;&emsp;
                                    <label for="status2">未审核：</label><input type="radio" name="status" id="status2"
                                                                            value="0" {{if list.status==0 }} checked {{/if}}/>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label no-padding-right">加入推荐：</label>
                                <div class="col-sm-10">
                                    <input type="checkbox" value="1" name="isbest" {{if list.isbest==1 }} checked {{/if}}>
                                    热门
                                    <input type="checkbox" value="1" name="ishot" {{if list.ishot==1 }} checked {{/if}}>
                                    推荐
                                    <input type="checkbox" value="1" name="isnew" {{if list.isnew==1 }} checked {{/if}}>
                                    新品
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="content">
                            <div class="form-group" style="height: auto;">
                                <!--label class="col-sm-2 control-label no-padding-right">文章详情:</label-->

                                <div class="col-sm-10"><script name="content" id="editor" type="text/plain" style="width: 90%;height:450px;"></script></div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="seo">
                            <div class="form-group">
                                <label class="col-sm-2 control-label no-padding-right" for="keywords">关键字：</label>

                                <div class="col-sm-10">
                                    <input type="text" id="keywords" name="keywords" class="col-xs-10 col-sm-5"
                                           value="{{list.keywords}}"/>
                                </div>
                            </div>
                            <div class="form-group" style="height:100px;">
                                <label class="col-sm-2 control-label no-padding-right" for="desc">描述：</label>
                                <div class="col-sm-10">
                                    <textarea style="height:100px;" class="col-xs-10 col-sm-5" name="desc" id="desc" cols="10" rows="10">{{list.desc}}</textarea>
                                </div>
                            </div>
                        </div>
                </div>


                <div class="form-group">
                    <label class="col-sm-2 control-label no-padding-right"></label>

                    <div class="col-sm-10">
                        <button type="submit" class="btn btn-primary">提交</button>
                    </div>

                </div>


                </form>

            </div>

        </div>
    </div><!-- /.main-content -->

</div><!-- /.main-container-inner -->

<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
    <i class="icon-double-angle-up icon-only bigger-110"></i>
</a>
</div><!-- /.main-container -->


{{include 'admin/public/footer.html'}}

<script type="text/javascript">
    //初始化编辑器 参数要对应引入的id
    var ue = UE.getEditor('editor');

    //编辑模式下 设置编辑器内容
    ue.addListener('ready', function () {
        ue.setContent('{{@list.content}}');//模板字符串
    });


    //分类改变的时候，把分类的名称赋值给表单域
    var pidDom = document.getElementById('pid');
    var catenameDom = document.getElementById('catename');
    var options = pidDom.getElementsByTagName('option');

    pidDom.onchange = function () {
        //当分类改变的时间 获取选中的值赋值给catename
        for (var i = 0; i < options.length; i++) {
            if (options[i].selected) {
                catenameDom.value = options[i].innerHTML;
            }
        }
    }

</script>

</body>
</html>

